USE master;
Go


-- Drop and recreate the 'DataWarehouse' database
IF EXISTS (SELECT 1 FROM sys.databases WHERE name = 'DataWarehouse')
BEGIN
    ALTER DATABASE DataWarehouse SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
    DROP DATABASE DataWarehouse;
END;
GO

-- Create the 'DataWarehouse' database
Create Database Datawarehouse;
GO

USE Datawarehouse;

Create schema Bronze;
GO
Create schema Silver;
GO
Create schema Gold;
Go


If object_id('Bronze.crm_cust_info' ,'U') is NOT NULL DROP TABLE Bronze.crm_cust_info;

Create Table Bronze.crm_cust_info(
cst_id INT,
cst_key nvarchar(50),
cst_firstname nvarchar(50),
cst_lastname nvarchar(50),
cst_martial_status nvarchar(50),
cst_gndr nvarchar(50),
cst_create_date Date
)

If object_id('Bronze.crm_prd_info' ,'U') is NOT NULL DROP TABLE Bronze.crm_prd_info;


Create Table Bronze.crm_prd_info(
prd_id INT,
prd_key nvarchar(50),
prd_nm nvarchar(50),
prd_cost INT,
prd_line nvarchar(50),
prd_start_dt Datetime,
prd_end_dt Datetime
)

If object_id('Bronze.crm_sales_details' ,'U') is NOT NULL DROP TABLE Bronze.crm_sales_details;

Create Table Bronze.crm_sales_details(
sls_ord_num nvarchar(50),
sls_prd_key nvarchar(50),
sls_cst_id INT,
sls_order_dt INT,
sls_ship_dt INT,
sls_due_dt INT,
sls_create_date INT,
sls_sales INT  ,
sls_quantity nvarchar(Max),
sls_price nvarchar(Max)
)

If object_id('Bronze.erp_CUST_AZ12' ,'U') is NOT NULL DROP TABLE Bronze.erp_CUST_AZ12;

Create Table Bronze.erp_CUST_AZ12(
CID nvarchar(50),
BDATE Date,
GEN nvarchar(50)
)

If object_id('Bronze.erp_LOC_A101' ,'U') is NOT NULL DROP TABLE Bronze.erp_LOC_A101;

Create Table Bronze.erp_LOC_A101(
CID nvarchar(50),
CNTRY nvarchar(50)
)

If object_id('Bronze.erp_PX_CAT_G1V2' ,'U') is NOT NULL DROP TABLE Bronze.erp_PX_CAT_G1V2;

Create Table Bronze.erp_PX_CAT_G1V2(
ID nvarchar(50),
CAT nvarchar(50),
SUBCAT nvarchar(50),
MAINTENANCE nvarchar(50),
)

select*from Bronze.crm_sales_details;



Truncate Table Bronze.crm_cust_info;
BULK INSERT Bronze.crm_cust_info 
from 'C:\Users\HP\Downloads\sql-data-warehouse-project\datasets\source_crm\cust_info.csv'
WITH 
(
Firstrow = 2,
FIELDTERMINATOR = ',',
tablock
)


Truncate Table Bronze.crm_prd_info;
BULK INSERT Bronze.crm_prd_info 
FROM 'C:\Users\HP\Downloads\sql-data-warehouse-project\datasets\source_crm\prd_info.csv'
WITH
( 
FIRSTROW = 2,
FIELDTERMINATOR = ',',
TABLOCK
)

		
Truncate Table Bronze.crm_sales_details;
BULK INSERT Bronze.crm_sales_details
FROM 'C:\Users\HP\Downloads\sql-data-warehouse-project\datasets\source_crm\sales_details.csv'
WITH
(
FIRSTROW = 2,
FIELDTERMINATOR = ',',
TABLOCK
)

Truncate Table Bronze.erp_CUST_AZ12;
BULK INSERT Bronze.erp_CUST_AZ12
FROM 'C:\Users\HP\Downloads\sql-data-warehouse-project\datasets\source_erp\CUST_AZ12.csv'
WITH
(
FIRSTROW = 2,
FIELDTERMINATOR = ',',
TABLOCK
)



Truncate Table Bronze.erp_LOC_A101;
BULK INSERT Bronze.erp_LOC_A101
FROM 'C:\Users\HP\Downloads\sql-data-warehouse-project\datasets\source_erp\LOC_A101.csv'
WITH
(
FIRSTROW = 2,
FIELDTERMINATOR = ',',
TABLOCK
)


Truncate Table Bronze.erp_PX_CAT_G1V2;
BULK INSERT Bronze.erp_PX_CAT_G1V2
FROM 'C:\Users\HP\Downloads\sql-data-warehouse-project\datasets\source_erp\PX_CAT_G1V2.csv'
WITH
(
FIRSTROW = 2,
FIELDTERMINATOR = ',',
TABLOCK
)
